<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>Module: ActionDispatch::Assertions::RoutingAssertions</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../../rdoc-style.css" type="text/css" media="screen" />

    <script language="JavaScript" type="text/javascript">
    // <![CDATA[

        function toggleSource( id )
        {
          var elem
          var link

          if( document.getElementById )
          {
            elem = document.getElementById( id )
            link = document.getElementById( "l_" + id )
          }
          else if ( document.all )
          {
            elem = eval( "document.all." + id )
            link = eval( "document.all.l_" + id )
          }
          else
            return false;

          if( elem.style.display == "block" )
          {
            elem.style.display = "none"
            link.innerHTML = "show source"
          }
          else
          {
            elem.style.display = "block"
            link.innerHTML = "hide source"
          }
        }

        function openCode( url )
        {
          window.open( url, "SOURCE_CODE", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=480,width=750" ).focus();
        }
      // ]]>
    </script>
  </head>

  <body>
    <table width="100%" border='0' cellpadding='0' cellspacing='0' class='banner'>
    <tr><td>Ruby on Rails v3.0.3</td></tr>
    <tr>
  <td class="file-title"><span class="file-title-prefix">Module</span><br />ActionDispatch::Assertions::RoutingAssertions</td>
  <td align="right">
    <table cellspacing="0" cellpadding="2">
      <tr valign="top">
        <td>In:</td>
        <td>
<a href="../../../files/actionpack/lib/action_dispatch/testing/assertions/routing_rb.html">actionpack/lib/action_dispatch/testing/assertions/routing.rb</a>:
        </td>
      </tr>
         </table>
        </td>
        </tr>
      </table>
  <div id="bodyContent">
  <div id="content">

  <div class="description"><p>
Suite of assertions to test routes generated by Rails and the handling of
requests made to them.
</p>
</div>


  <div class="sectiontitle">Methods</div>
  <ul>
                <li><a href="#method-i-assert_generates">assert_generates</a></li>
                <li><a href="#method-i-assert_recognizes">assert_recognizes</a></li>
                <li><a href="#method-i-assert_routing">assert_routing</a></li>
                <li><a href="#method-i-method_missing">method_missing</a></li>
                <li><a href="#method-i-recognized_request_for">recognized_request_for</a></li>
                <li><a href="#method-i-with_routing">with_routing</a></li>
      </ul>




                        
    <div class="sectiontitle">
      Public      Instance      methods
    </div>

          
      <div class="method">
        <div class="title">
                      <a name="method-i-assert_generates"></a>
            <b>assert_generates</b>(expected_path, options, defaults={}, extras = {}, message=nil)          
        </div>

                  <div class="description">
            <p>
Asserts that the provided options can be used to generate the provided
path.  This is the inverse of <tt><a
href="RoutingAssertions.html#method-i-assert_recognizes">assert_recognizes</a></tt>.
The <tt>extras</tt> parameter is used to tell the request the names and
values of additional request parameters that would be in a query string.
The <tt>message</tt> parameter allows you to specify a custom error message
for assertion failures.
</p>
<p>
The <tt>defaults</tt> parameter is unused.
</p>
<h4>Examples</h4>
<pre>
  # Asserts that the default action is generated for a route with no action
  assert_generates &quot;/items&quot;, :controller =&gt; &quot;items&quot;, :action =&gt; &quot;index&quot;

  # Tests that the list action is properly routed
  assert_generates &quot;/items/list&quot;, :controller =&gt; &quot;items&quot;, :action =&gt; &quot;list&quot;

  # Tests the generation of a route with a parameter
  assert_generates &quot;/items/list/1&quot;, { :controller =&gt; &quot;items&quot;, :action =&gt; &quot;list&quot;, :id =&gt; &quot;1&quot; }

  # Asserts that the generated route gives us our custom route
  assert_generates &quot;changesets/12&quot;, { :controller =&gt; 'scm', :action =&gt; 'show_diff', :revision =&gt; &quot;12&quot; }</pre>          </div>
        
        
                  <div class="sourcecode">
            <p class="source-link">[
            <a href="javascript:toggleSource('assert-generates_source')"
                 id="l_method-i-assert_generates_source">
              show source
            </a> ]</p>
            <div class="dyn-source"
                    id="assert-generates_source">
<pre>
      <span class="ruby-comment cmt"># File actionpack/lib/action_dispatch/testing/assertions/routing.rb, line 73</span>
73:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">assert_generates</span>(<span class="ruby-identifier">expected_path</span>, <span class="ruby-identifier">options</span>, <span class="ruby-identifier">defaults</span>={}, <span class="ruby-identifier">extras</span> = {}, <span class="ruby-identifier">message</span>=<span class="ruby-keyword kw">nil</span>)
74:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">expected_path</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">%{://}</span>
75:           <span class="ruby-keyword kw">begin</span>
76:             <span class="ruby-identifier">uri</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">expected_path</span>)
77:             <span class="ruby-identifier">expected_path</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">?</span> <span class="ruby-value str">&quot;/&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>
78:           <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidURIError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
79:             <span class="ruby-identifier">raise</span> <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">RoutingError</span>, <span class="ruby-identifier">e</span>.<span class="ruby-identifier">message</span>
80:           <span class="ruby-keyword kw">end</span>
81:         <span class="ruby-keyword kw">else</span>
82:           <span class="ruby-identifier">expected_path</span> = <span class="ruby-node">&quot;/#{expected_path}&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">expected_path</span>.<span class="ruby-identifier">first</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'/'</span>
83:         <span class="ruby-keyword kw">end</span>
84:         <span class="ruby-comment cmt"># Load routes.rb if it hasn't been loaded.</span>
85: 
86:         <span class="ruby-identifier">generated_path</span>, <span class="ruby-identifier">extra_keys</span> = <span class="ruby-ivar">@routes</span>.<span class="ruby-identifier">generate_extras</span>(<span class="ruby-identifier">options</span>, <span class="ruby-identifier">defaults</span>)
87:         <span class="ruby-identifier">found_extras</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">reject</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span> <span class="ruby-identifier">extra_keys</span>.<span class="ruby-identifier">include?</span> <span class="ruby-identifier">k</span>}
88: 
89:         <span class="ruby-identifier">msg</span> = <span class="ruby-identifier">build_message</span>(<span class="ruby-identifier">message</span>, <span class="ruby-value str">&quot;found extras &lt;?&gt;, not &lt;?&gt;&quot;</span>, <span class="ruby-identifier">found_extras</span>, <span class="ruby-identifier">extras</span>)
90:         <span class="ruby-identifier">assert_block</span>(<span class="ruby-identifier">msg</span>) { <span class="ruby-identifier">found_extras</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">extras</span> }
91: 
92:         <span class="ruby-identifier">msg</span> = <span class="ruby-identifier">build_message</span>(<span class="ruby-identifier">message</span>, <span class="ruby-value str">&quot;The generated path &lt;?&gt; did not match &lt;?&gt;&quot;</span>, <span class="ruby-identifier">generated_path</span>,
93:             <span class="ruby-identifier">expected_path</span>)
94:         <span class="ruby-identifier">assert_block</span>(<span class="ruby-identifier">msg</span>) { <span class="ruby-identifier">expected_path</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">generated_path</span> }
95:       <span class="ruby-keyword kw">end</span></pre>
            </div>
          </div>
        
      </div>

          
      <div class="method">
        <div class="title">
                      <a name="method-i-assert_recognizes"></a>
            <b>assert_recognizes</b>(expected_options, path, extras={}, message=nil)          
        </div>

                  <div class="description">
            <p>
Asserts that the routing of the given <tt>path</tt> was handled correctly
and that the parsed options (given in the <tt>expected_options</tt> hash)
match <tt>path</tt>.  Basically, it asserts that Rails recognizes the route
given by <tt>expected_options</tt>.
</p>
<p>
Pass a hash in the second argument (<tt>path</tt>) to specify the request
method.  This is useful for routes requiring a specific HTTP method.  The
hash should contain a :path with the incoming request path and a :method
containing the required HTTP verb.
</p>
<pre>
  # assert that POSTing to /items will call the create action on ItemsController
  assert_recognizes({:controller =&gt; 'items', :action =&gt; 'create'}, {:path =&gt; 'items', :method =&gt; :post})
</pre>
<p>
You can also pass in <tt>extras</tt> with a hash containing URL parameters
that would normally be in the query string.  This can be used to assert
that values in the query string string will end up in the params hash
correctly.  To test query strings you must use the extras argument,
appending the query string on the path directly will not work.  For
example:
</p>
<pre>
  # assert that a path of '/items/list/1?view=print' returns the correct options
  assert_recognizes({:controller =&gt; 'items', :action =&gt; 'list', :id =&gt; '1', :view =&gt; 'print'}, 'items/list/1', { :view =&gt; &quot;print&quot; })
</pre>
<p>
The <tt>message</tt> parameter allows you to pass in an error message that
is displayed upon failure.
</p>
<h4>Examples</h4>
<pre>
  # Check the default route (i.e., the index action)
  assert_recognizes({:controller =&gt; 'items', :action =&gt; 'index'}, 'items')

  # Test a specific action
  assert_recognizes({:controller =&gt; 'items', :action =&gt; 'list'}, 'items/list')

  # Test an action with a parameter
  assert_recognizes({:controller =&gt; 'items', :action =&gt; 'destroy', :id =&gt; '1'}, 'items/destroy/1')

  # Test a custom route
  assert_recognizes({:controller =&gt; 'items', :action =&gt; 'show', :id =&gt; '1'}, 'view/item1')

  # Check a Simply RESTful generated route
  assert_recognizes list_items_url, 'items/list'</pre>          </div>
        
        
                  <div class="sourcecode">
            <p class="source-link">[
            <a href="javascript:toggleSource('assert-recognizes_source')"
                 id="l_method-i-assert_recognizes_source">
              show source
            </a> ]</p>
            <div class="dyn-source"
                    id="assert-recognizes_source">
<pre>
      <span class="ruby-comment cmt"># File actionpack/lib/action_dispatch/testing/assertions/routing.rb, line 43</span>
43:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">assert_recognizes</span>(<span class="ruby-identifier">expected_options</span>, <span class="ruby-identifier">path</span>, <span class="ruby-identifier">extras</span>={}, <span class="ruby-identifier">message</span>=<span class="ruby-keyword kw">nil</span>)
44:         <span class="ruby-identifier">request</span> = <span class="ruby-identifier">recognized_request_for</span>(<span class="ruby-identifier">path</span>)
45: 
46:         <span class="ruby-identifier">expected_options</span> = <span class="ruby-identifier">expected_options</span>.<span class="ruby-identifier">clone</span>
47:         <span class="ruby-identifier">extras</span>.<span class="ruby-identifier">each_key</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span> <span class="ruby-identifier">expected_options</span>.<span class="ruby-identifier">delete</span> <span class="ruby-identifier">key</span> } <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">extras</span>.<span class="ruby-identifier">nil?</span>
48: 
49:         <span class="ruby-identifier">expected_options</span>.<span class="ruby-identifier">stringify_keys!</span>
50:         <span class="ruby-identifier">msg</span> = <span class="ruby-identifier">build_message</span>(<span class="ruby-identifier">message</span>, <span class="ruby-value str">&quot;The recognized options &lt;?&gt; did not match &lt;?&gt;, difference: &lt;?&gt;&quot;</span>,
51:             <span class="ruby-identifier">request</span>.<span class="ruby-identifier">path_parameters</span>, <span class="ruby-identifier">expected_options</span>, <span class="ruby-identifier">expected_options</span>.<span class="ruby-identifier">diff</span>(<span class="ruby-identifier">request</span>.<span class="ruby-identifier">path_parameters</span>))
52:         <span class="ruby-identifier">assert_block</span>(<span class="ruby-identifier">msg</span>) { <span class="ruby-identifier">request</span>.<span class="ruby-identifier">path_parameters</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">expected_options</span> }
53:       <span class="ruby-keyword kw">end</span></pre>
            </div>
          </div>
        
      </div>

          
      <div class="method">
        <div class="title">
                      <a name="method-i-assert_routing"></a>
            <b>assert_routing</b>(path, options, defaults={}, extras={}, message=nil)          
        </div>

                  <div class="description">
            <p>
Asserts that path and options match both ways; in other words, it verifies
that <tt>path</tt> generates <tt>options</tt> and then that
<tt>options</tt> generates <tt>path</tt>.  This essentially combines <tt><a
href="RoutingAssertions.html#method-i-assert_recognizes">assert_recognizes</a></tt>
and <tt><a
href="RoutingAssertions.html#method-i-assert_generates">assert_generates</a></tt>
into one step.
</p>
<p>
The <tt>extras</tt> hash allows you to specify options that would normally
be provided as a query string to the action.  The <tt>message</tt>
parameter allows you to specify a custom error message to display upon
failure.
</p>
<h4>Examples</h4>
<pre>
 # Assert a basic route: a controller with the default action (index)
 assert_routing '/home', :controller =&gt; 'home', :action =&gt; 'index'

 # Test a route generated with a specific controller, action, and parameter (id)
 assert_routing '/entries/show/23', :controller =&gt; 'entries', :action =&gt; 'show', :id =&gt; 23

 # Assert a basic route (controller + default action), with an error message if it fails
 assert_routing '/store', { :controller =&gt; 'store', :action =&gt; 'index' }, {}, {}, 'Route for store index not generated properly'

 # Tests a route, providing a defaults hash
 assert_routing 'controller/action/9', {:id =&gt; &quot;9&quot;, :item =&gt; &quot;square&quot;}, {:controller =&gt; &quot;controller&quot;, :action =&gt; &quot;action&quot;}, {}, {:item =&gt; &quot;square&quot;}

 # Tests a route with a HTTP method
 assert_routing({ :method =&gt; 'put', :path =&gt; '/product/321' }, { :controller =&gt; &quot;product&quot;, :action =&gt; &quot;update&quot;, :id =&gt; &quot;321&quot; })</pre>          </div>
        
        
                  <div class="sourcecode">
            <p class="source-link">[
            <a href="javascript:toggleSource('assert-routing_source')"
                 id="l_method-i-assert_routing_source">
              show source
            </a> ]</p>
            <div class="dyn-source"
                    id="assert-routing_source">
<pre>
       <span class="ruby-comment cmt"># File actionpack/lib/action_dispatch/testing/assertions/routing.rb, line 119</span>
119:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">assert_routing</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span>, <span class="ruby-identifier">defaults</span>={}, <span class="ruby-identifier">extras</span>={}, <span class="ruby-identifier">message</span>=<span class="ruby-keyword kw">nil</span>)
120:         <span class="ruby-identifier">assert_recognizes</span>(<span class="ruby-identifier">options</span>, <span class="ruby-identifier">path</span>, <span class="ruby-identifier">extras</span>, <span class="ruby-identifier">message</span>)
121: 
122:         <span class="ruby-identifier">controller</span>, <span class="ruby-identifier">default_controller</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:controller</span>], <span class="ruby-identifier">defaults</span>[<span class="ruby-value">:controller</span>]
123:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">controller</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">controller</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value">//</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">default_controller</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">default_controller</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value">//</span>)
124:           <span class="ruby-identifier">options</span>[<span class="ruby-value">:controller</span>] = <span class="ruby-node">&quot;/#{controller}&quot;</span>
125:         <span class="ruby-keyword kw">end</span>
126: 
127:         <span class="ruby-identifier">assert_generates</span>(<span class="ruby-identifier">path</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">path</span>[<span class="ruby-value">:path</span>] <span class="ruby-operator">:</span> <span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span>, <span class="ruby-identifier">defaults</span>, <span class="ruby-identifier">extras</span>, <span class="ruby-identifier">message</span>)
128:       <span class="ruby-keyword kw">end</span></pre>
            </div>
          </div>
        
      </div>

          
      <div class="method">
        <div class="title">
                      <a name="method-i-method_missing"></a>
            <b>method_missing</b>(selector, *args, &block)          
        </div>

                  <div class="description">
            <p>
ROUTES TODO: These assertions should really work in an integration context
</p>          </div>
        
        
                  <div class="sourcecode">
            <p class="source-link">[
            <a href="javascript:toggleSource('method-missing_source')"
                 id="l_method-i-method_missing_source">
              show source
            </a> ]</p>
            <div class="dyn-source"
                    id="method-missing_source">
<pre>
       <span class="ruby-comment cmt"># File actionpack/lib/action_dispatch/testing/assertions/routing.rb, line 173</span>
173:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">method_missing</span>(<span class="ruby-identifier">selector</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
174:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@controller</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@routes</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@routes</span>.<span class="ruby-identifier">named_routes</span>.<span class="ruby-identifier">helpers</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">selector</span>)
175:           <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">selector</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
176:         <span class="ruby-keyword kw">else</span>
177:           <span class="ruby-keyword kw">super</span>
178:         <span class="ruby-keyword kw">end</span>
179:       <span class="ruby-keyword kw">end</span></pre>
            </div>
          </div>
        
      </div>

          
      <div class="method">
        <div class="title">
                      <a name="method-i-with_routing"></a>
            <b>with_routing</b>()          
        </div>

                  <div class="description">
            <p>
A helper to make it easier to test different route configurations. This
method temporarily replaces @routes with a new RouteSet instance.
</p>
<p>
The new instance is yielded to the passed block. Typically the block will
create some routes using <tt>map.draw { map.connect ... }</tt>:
</p>
<pre>
  with_routing do |set|
    set.draw do |map|
      map.connect ':controller/:action/:id'
        assert_equal(
          ['/content/10/show', {}],
          map.generate(:controller =&gt; 'content', :id =&gt; 10, :action =&gt; 'show')
      end
    end
  end</pre>          </div>
        
        
                  <div class="sourcecode">
            <p class="source-link">[
            <a href="javascript:toggleSource('with-routing_source')"
                 id="l_method-i-with_routing_source">
              show source
            </a> ]</p>
            <div class="dyn-source"
                    id="with-routing_source">
<pre>
       <span class="ruby-comment cmt"># File actionpack/lib/action_dispatch/testing/assertions/routing.rb, line 147</span>
147:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">with_routing</span>
148:         <span class="ruby-identifier">old_routes</span>, <span class="ruby-ivar">@routes</span> = <span class="ruby-ivar">@routes</span>, <span class="ruby-constant">ActionDispatch</span><span class="ruby-operator">::</span><span class="ruby-constant">Routing</span><span class="ruby-operator">::</span><span class="ruby-constant">RouteSet</span>.<span class="ruby-identifier">new</span>
149:         <span class="ruby-identifier">old_controller</span>, <span class="ruby-ivar">@controller</span> = <span class="ruby-ivar">@controller</span>, <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">clone</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@controller</span>
150:         <span class="ruby-identifier">_routes</span> = <span class="ruby-ivar">@routes</span>
151: 
152:         <span class="ruby-comment cmt"># Unfortunately, there is currently an abstraction leak between AC::Base</span>
153:         <span class="ruby-comment cmt"># and AV::Base which requires having the URL helpers in both AC and AV.</span>
154:         <span class="ruby-comment cmt"># To do this safely at runtime for tests, we need to bump up the helper serial</span>
155:         <span class="ruby-comment cmt"># to that the old AV subclass isn't cached.</span>
156:         <span class="ruby-comment cmt">#</span>
157:         <span class="ruby-comment cmt"># TODO: Make this unnecessary</span>
158:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@controller</span>
159:           <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">singleton_class</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:include</span>, <span class="ruby-identifier">_routes</span>.<span class="ruby-identifier">url_helpers</span>)
160:           <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">view_context_class</span> = <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">view_context_class</span>) <span class="ruby-keyword kw">do</span>
161:             <span class="ruby-identifier">include</span> <span class="ruby-identifier">_routes</span>.<span class="ruby-identifier">url_helpers</span>
162:           <span class="ruby-keyword kw">end</span>
163:         <span class="ruby-keyword kw">end</span>
164:         <span class="ruby-keyword kw">yield</span> <span class="ruby-ivar">@routes</span>
165:       <span class="ruby-keyword kw">ensure</span>
166:         <span class="ruby-ivar">@routes</span> = <span class="ruby-identifier">old_routes</span>
167:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@controller</span>
168:           <span class="ruby-ivar">@controller</span> = <span class="ruby-identifier">old_controller</span>
169:         <span class="ruby-keyword kw">end</span>
170:       <span class="ruby-keyword kw">end</span></pre>
            </div>
          </div>
        
      </div>

              
    <div class="sectiontitle">
      Private      Instance      methods
    </div>

          
      <div class="method">
        <div class="title">
                      <a name="method-i-recognized_request_for"></a>
            <b>recognized_request_for</b>(path)          
        </div>

                  <div class="description">
            <p>
Recognizes the route for a given path.
</p>          </div>
        
        
                  <div class="sourcecode">
            <p class="source-link">[
            <a href="javascript:toggleSource('recognized-request-for_source')"
                 id="l_method-i-recognized_request_for_source">
              show source
            </a> ]</p>
            <div class="dyn-source"
                    id="recognized-request-for_source">
<pre>
       <span class="ruby-comment cmt"># File actionpack/lib/action_dispatch/testing/assertions/routing.rb, line 183</span>
183:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">recognized_request_for</span>(<span class="ruby-identifier">path</span>)
184:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">path</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
185:             <span class="ruby-identifier">method</span> = <span class="ruby-identifier">path</span>[<span class="ruby-value">:method</span>]
186:             <span class="ruby-identifier">path</span>   = <span class="ruby-identifier">path</span>[<span class="ruby-value">:path</span>]
187:           <span class="ruby-keyword kw">else</span>
188:             <span class="ruby-identifier">method</span> = <span class="ruby-value">:get</span>
189:           <span class="ruby-keyword kw">end</span>
190: 
191:           <span class="ruby-comment cmt"># Assume given controller</span>
192:           <span class="ruby-identifier">request</span> = <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">TestRequest</span>.<span class="ruby-identifier">new</span>
193: 
194:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">path</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">%{://}</span>
195:             <span class="ruby-keyword kw">begin</span>
196:               <span class="ruby-identifier">uri</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">path</span>)
197:               <span class="ruby-identifier">request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">&quot;rack.url_scheme&quot;</span>] = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;http&quot;</span>
198:               <span class="ruby-identifier">request</span>.<span class="ruby-identifier">host</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">host</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">host</span>
199:               <span class="ruby-identifier">request</span>.<span class="ruby-identifier">port</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">port</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">port</span>
200:               <span class="ruby-identifier">request</span>.<span class="ruby-identifier">path</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">?</span> <span class="ruby-value str">&quot;/&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>
201:             <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidURIError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
202:               <span class="ruby-identifier">raise</span> <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">RoutingError</span>, <span class="ruby-identifier">e</span>.<span class="ruby-identifier">message</span>
203:             <span class="ruby-keyword kw">end</span>
204:           <span class="ruby-keyword kw">else</span>
205:             <span class="ruby-identifier">path</span> = <span class="ruby-node">&quot;/#{path}&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">path</span>.<span class="ruby-identifier">first</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;/&quot;</span>
206:             <span class="ruby-identifier">request</span>.<span class="ruby-identifier">path</span> = <span class="ruby-identifier">path</span>
207:           <span class="ruby-keyword kw">end</span>
208: 
209:           <span class="ruby-identifier">request</span>.<span class="ruby-identifier">request_method</span> = <span class="ruby-identifier">method</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">method</span>
210: 
211:           <span class="ruby-identifier">params</span> = <span class="ruby-ivar">@routes</span>.<span class="ruby-identifier">recognize_path</span>(<span class="ruby-identifier">path</span>, { <span class="ruby-value">:method</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">method</span> })
212:           <span class="ruby-identifier">request</span>.<span class="ruby-identifier">path_parameters</span> = <span class="ruby-identifier">params</span>.<span class="ruby-identifier">with_indifferent_access</span>
213: 
214:           <span class="ruby-identifier">request</span>
215:         <span class="ruby-keyword kw">end</span></pre>
            </div>
          </div>
        
      </div>

      </div>
  </div>
  </body>
</html>
